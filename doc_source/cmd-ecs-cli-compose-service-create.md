# ecs\-cli compose service create<a name="cmd-ecs-cli-compose-service-create"></a>

Creates an Amazon ECS service from your compose file\. The service is created with a desired count of `0`, so no containers are started by this command\.

## Syntax<a name="cmd-ecs-cli-compose-service-create-syntax"></a>

ecs\-cli compose service create \[\-\-deployment\-max\-percent *n*\] \[\-\-deployment\-min\-healthy\-percent *n*\] \[\-\-load\-balancer\-name *value*\] \[\-\-target\-group\-arn *value*\] \[\-\-target\-groups "targetGroupArn=arn:elasticloadbalancing:*region*:*aws\_account\_id*: targetgroup/*target\_group\_name\_1*,containerName=*container\_name*,containerPort=*container\_port*"\] \[\-\-container\-name *value*\] \[\-\-container\-port *value*\] \[\-\-role *value*\] \[\-\-launch\-type *launch\_type*\] \[\-\-health\-check\-grace\-period *integer*\] \[\-\-create\-log\-groups\] \[\-\-enable\-service\-discovery\] \[\-\-vpc *value*\] \[\-\-private\-dns\-namespace *value*\] \[\-\-private\-dns\-namespace\-id *value*\] \[\-\-public\-dns\-namespace *value*\] \[\-\-public\-dns\-namespace\-id *value*\] \[\-\-sd\-container\-name *value*\] \[\-\-sd\-container\-port *value*\] \[\-\-dns\-ttl *value*\] \[\-\-dns\-type *value*\] \[\-\-healthcheck\-custom\-config\-failure\-threshold *value*\] \[\-\-scheduling\-strategy *value*\] \[\-\-tags *key1=value1,key2=value2*\] \[\-\-disable\-ecs\-managed\-tags\] \[\-\-help\]

## Options<a name="cmd-ecs-cli-compose-service-create-options"></a>


| Name | Description | 
| --- | --- | 
|  `--deployment-max-percent`  |  Specifies the upper limit \(as a percentage of the service's `desiredCount`\) of the number of running tasks that can be running in a service during a deployment\. For more information, see [maximumPercent](service_definition_parameters.md#maximumPercent)\. Default value: `200` Required: No  | 
|  `--deployment-min-healthy-percent`  |  Specifies the lower limit \(as a percentage of the service's desiredCount\) of the number of running tasks that must remain running and healthy in a service during a deployment\. For more information, see [minimumHealthyPercent](service_definition_parameters.md#minimumHealthyPercent)\. Default value: `100` Required: No  | 
|  `--target-group-arn`  |  Specifies the full Amazon Resource Name \(ARN\) of a previously configured Elastic Load Balancing target group to associate with your service\. **Deprecated**, use `target-groups`\. Required: No  | 
|  `--target-groups`  |  Specifies one or more target groups to be registered with the service\. Specify the Amazon Resource Name \(ARN\) of the target group, the container name and the container port for each group to register\. A single `--target-groups` flag specifies only one target group\. Add additional `--target-groups` flags to add additional target groups\. Type: Strings For more information see [Registering multiple target groups with a service](register-multiple-targetgroups.md)\. Required: No  | 
|  `--container-name`  |  Specifies the container name \(as it appears in a container definition\)\. This parameter is required if a load balancer or target group is specified\. **Deprecated**, use `target-groups`\. Required: No, unless a load balancer or target group is specified\.  | 
|  `--container-port`  |  Specifies the port on the container to associate with the load balancer\. This port must correspond to a `containerPort` in the service's task definition\. This parameter is required if a load balancer or target group is specified\. **Deprecated**, use `target-groups`\. Required: No, unless a load balancer or target group is specified\.  | 
|  `--load-balancer-name`  |  Specifies the name of a previously configured Elastic Load Balancing load balancer to associate with your service\. **Deprecated**, use `target-groups`\. Required: No  | 
|  `--role`  |  Specifies the name or full Amazon Resource Name \(ARN\) of the IAM role that allows Amazon ECS to make calls to your load balancer or target group on your behalf\. This parameter is required if you're using a load balancer or target group with your service\. If you specify the role parameter, you must also specify a load balancer name or target group ARN, along with a container name and container port\. Required: No, unless a load balancer or target group is specified\.  | 
|  `--health-check-grace-period`  |  Specifies the period of time, in seconds, that the Amazon ECS service scheduler should ignore unhealthy Elastic Load Balancing target health checks after a task has first started\. Required: No  | 
|  `--create-log-groups`  |  Creates the CloudWatch log groups specified in your Compose files\. Required: No  | 
|  `--enable-service-discovery`  |  Specifies whether to enable service discovery for this service\. Required: No  | 
| `--vpc` |  Specifies the VPC that will be attached to the private DNS namespace for service discovery\. This parameter is required if `--private-dns-namespace` is specified\. Required: No  | 
| `--private-dns-namespace` |  Specifies the name of the private DNS namespace to use with service discovery\. The Amazon ECS CLI automatically creates the namespace if it doesn't exist\. For example, if the namespace is `corp`, a service named `foo` is reachable via DNS at `foo.corp`\. If you use this parameter, you must also specify a VPC using the `--vpc` parameter\. Required: No  | 
| `--private-dns-namespace-id` |  Specifies the ID of an existing private DNS namespace to use with service discovery\. If you use this parameter, you can't specify either `--private-dns-namespace` or `--vpc`\. Required: No  | 
| `--public-dns-namespace` |  Specifies the name of the public DNS namespace to use with service discovery\. For example, if the namespace is `corp`, a service named `foo` is reachable via DNS at `foo.corp`\. Required: No  | 
| `--public-dns-namespace-id` |  Specifies the ID of an existing public DNS namespace to use with service discovery\. If you use this parameter, you can't specify a `--public-dns-namespace`\. Required: No  | 
| `--sd-container-name` |  Specifies the name of the container, which is referred to as a service in your Docker Compose file\. For more information, see [Service configuration reference](https://docs.docker.com/compose/compose-file/compose-file-v2/#service-configuration-reference)\. This parameter is required if you're using SRV records\. Required: No, unless SRV DNS records are being used\.  | 
| `--sd-container-port` |  Specifies the port on the container that will be used for service discovery\. This parameter is required if you're using SRV records\. Required: No, unless SRV DNS records are being used\.  | 
| `--dns-ttl` |  Specifies the amount of time, in seconds, that you want DNS resolvers to cache the settings for the DNS records used for service discovery\. Default value: `60` Required: No  | 
| `--dns-type` |  Specifies the type of DNS record used for service discovery\. Accepted values are `A` or `SRV`\. If your task uses either the `bridge` or `host` network modes, `SRV` records are required\. If your task uses the `awsvpc` network mode, `A` records are the default\. Required: No  | 
| `--healthcheck-custom-config-failure-threshold` |  Specifies the number of 30\-second intervals that you want the service discovery service to wait after receiving an `UpdateInstanceCustomHealthStatus` request before it changes the health status\. Default value: `1` Required: No  | 
|  `--scheduling-strategy value`  |  Specifies the scheduling strategy to use for the service\. There are two service scheduler strategies available: [\[See the AWS documentation website for more details\]](http://docs.aws.amazon.com/AmazonECS/latest/developerguide/cmd-ecs-cli-compose-service-create.html) For more information, see [Service scheduler concepts](ecs_services.md#service_scheduler)\. Type: String Valid values: `REPLICA` \| `DAEMON` Default value: `REPLICA` Required: No  | 
|  `--tags key1=value1,key2=value2`  |  Specifies the metadata to apply to your AWS resources\. Each tag consists of a key and an optional value\. Tags use the following format: `key1=value1,key2=value2,key3=value3`\. Amazon ECS managed tags are enabled by default if you have opted in to the new Amazon Resource Name \(ARN\) and resource identifier \(ID\) formats unless you specifically disable them using the `--disable-ecs-managed-tags` flag\. For more information, see [Tagging Resources](cmd-ecs-cli-compose-service-up.md#cmd-ecs-cli-compose-service-up-tags)\. Type: Key value pairs Required: No  | 
|  `--disable-ecs-managed-tags`  |  Disable the Amazon ECS managed tags\. For more information, see [Tagging your resources for billing](ecs-using-tags.md#tag-resources-for-billing)\. Required: No  | 
|  `--region, -r region`  |  Specifies the AWS Region to use\. Defaults to the cluster configured using the configure command\. Type: String Required: No  | 
|  `--cluster-config cluster_config_name`  |  Specifies the name of the Amazon ECS cluster configuration to use\. Defaults to the cluster configuration set as the default\. Type: String Required: No  | 
|  `--ecs-profile ecs_profile`  |  Specifies the name of the Amazon ECS profile configuration to use\. Defaults to the profile configured using the configure profile command\. Type: String Required: No  | 
|  `--aws-profile aws_profile`  |  Specifies the AWS profile to use\. Enables you to use the AWS credentials from an existing named profile in `~/.aws/credentials`\. Type: String Required: No  | 
|  `--cluster, -c cluster_name`  |  Specifies the Amazon ECS cluster name to use\. Defaults to the cluster configured using the configure command\. Type: String Required: No  | 
|  `--help, -h`  |  Shows the help text for the specified command\. Required: No  | 

## Using a Load Balancer<a name="cmd-ecs-cli-compose-service-create-elb"></a>

You can optionally run your service behind a load balancer\. The load balancer distributes traffic across the tasks that are associated with the service\. For more information, see [Service load balancing](service-load-balancing.md)\. After you create a service, you can't change the load balancer name or target group ARN, container name, and container port specified in the service definition\.

**Note**  
You must create your load balancer resources before you can configure a service to use them\. Your load balancer resources should reside in the same VPC as your container instances, and they should be configured to use the same subnets\. You must also add a security group rule to your container instance security group that allows inbound traffic from your load balancer\. For more information, see [Creating a load balancer](create-load-balancer.md)\. 
+ To configure your service to use an existing Elastic Load Balancing Classic Load Balancer, you must specify the load balancer name, the container name \(as it appears in a container definition\), and the container port to access from the load balancer\. When a task from this service is placed on a container instance, the container instance is registered with the load balancer specified here\.
+ To configure your service to use an existing Elastic Load Balancing Application Load Balancer, you must specify the load balancer target group ARN, the container name \(as it appears in a container definition\), and the container port to access from the load balancer\. When a task from this service is placed on a container instance, the container instance and port combination is registered as a target in the target group specified here\.

The `--health-check-grace-period` option specifies the period of time, in seconds, that the Amazon ECS service scheduler should ignore unhealthy Elastic Load Balancing target health checks after a task has first started\. This is valid only if your service is configured to use a load balancer\. If your tasks take a while to start and respond to Elastic Load Balancing health checks, you can specify a health check grace period of up to 1,800 seconds during which the Amazon ECS service scheduler ignores the Elastic Load Balancing health check status\. This grace period can prevent the Amazon ECS service scheduler from marking tasks as unhealthy and stopping them before they have time to come up\.

## Using Service Discovery<a name="cmd-ecs-cli-compose-service-create-sd"></a>

Your Amazon ECS service can optionally be configured to use Amazon ECS Service Discovery\. Service discovery uses Amazon Route 53 auto naming API actions to manage DNS entries for your service's tasks, making them discoverable within your VPC\. For more information, see [Tutorial: Creating an Amazon ECS Service That Uses Service Discovery Using the Amazon ECS CLI](ecs-cli-tutorial-servicediscovery.md)\.

## Tagging Resources<a name="cmd-ecs-cli-compose-service-create-tags"></a>

The Amazon ECS CLI supports adding metadata in the form of resource tags to your AWS resources\. Each tag consists of a key and an optional value\. Resource tags can be used for cost allocation, automation, and access control\. For more information, see [Tagging your Amazon ECS resources](ecs-using-tags.md)\.

When using the `ecs-cli compose service create` command, using the `--tags` flag allows you to add metadata tags to the task definition and service\. The tags are added to the service and task definition when the resources are created\. The tags are propogated from your task definition to tasks created by the service\. Amazon ECS managed tags are enabled by default if you have opted in to the new Amazon Resource Name \(ARN\) and resource identifier \(ID\) formats unless you specifically disable them using the `--disable-ecs-managed-tags` flag\. For more information, see [Tagging your resources for billing](ecs-using-tags.md#tag-resources-for-billing)\.